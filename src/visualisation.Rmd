---
title: "Visualisation"
output: github_document
---

```{r}
load("/home/ilpo/Paavo/data/preprocessed.RData")
preprosessed_paavo$zip <- gsub('.*NA.*',NA,preprosessed_paavo$zip)
preprosessed_paavo$Year <- gsub('.*NA.*',NA,preprosessed_paavo$Year)
```


```{r}
knitr::opts_chunk$set(echo = TRUE)

```
```{r}
setwd(dir="/home/ilpo/Paavo/src")
getwd()

```


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}

library(tidyverse)
library(lubridate)





```




filtering prop_donors smaller than 1 and took common logarithm 
```{r}
preprosessed_paavo %>% 
filter(prop_donors<=1) %>% 
ggplot(aes(x = averageincome, y= prop_donors, color=prop_donors)) +
geom_point(alpha = 0.25) +
geom_smooth(method=lm) +
scale_x_log10()  +
#facet_grid(Year~.) +
labs(x = "Average income",
         y = "Proportion of donors",
         title = "Proportion of donors per average income")
```


#Logarithm and filtering. 

```{r}
preprosessed_paavo %>% 
filter(prop_donors<=1) %>% 
ggplot(aes(y = prop_donors, x = medianincome, color=prop_donors)) +
geom_point(alpha = 0.25) +
scale_x_log10() +
#geom_smooth () +
labs(x = "Median income",
         y = "Proportion of donors",
         title = "Proportion of donors per median income of postal codes per year")+
facet_grid(Year ~.)
```





```{r}
preprosessed_paavo %>% 
filter(prop_donors<=1) %>% 
ggplot(aes(y = prop_donors, x = medianincome, color=prop_donors)) +
geom_point(alpha = 0.25) +
scale_x_log10() +
geom_smooth (method=lm, se=FALSE) +
labs(x = "Median income",
         y = "Proportion of donors",
         title = "Proportion of donors per median income of postal codes")
#facet_grid(Year ~.)
```




```{r}
preprosessed_paavo %>%  
filter(proportion_inhabitants_with_higher_education <= 1) %>% 
ggplot(aes(x=proportion_inhabitants_with_higher_education, y=  prop_donors, color= prop_donors)) +
geom_jitter(alpha= 0.4)+
geom_smooth(method=lm)+
labs(x = "Proportion of inhabitants with higher education",
         y = "Proportion of donors",
         title = "Proportion of donors per proportion of people with university degree") 
#facet_grid (Year~.)
  
```


 Is there a relationship between proportion of people with higher education and proportion of donors in the population? 

        

 
```{r}
preprosessed_paavo %>% 
ggplot(aes(x =  proportion_inhabitants_with_higher_education, y = prop_repeat_donors, col= prop_repeat_donors))+
geom_point() +
geom_smooth (method=lm)
```


```{r}



```







